<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from /home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/robots/eufs/robot.urdf.xacro | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="eufs">
  <!-- ***************** -->
  <!-- Config parameters -->
  <!-- ***************** -->
  <!-- ***************** -->
  <!-- Global parameters -->
  <!-- ***************** -->
  <!-- ***************** -->
  <!-- Imported elements -->
  <!-- ***************** -->
  <!-- This file unifies all sensors that can be used on simulation, defined as xacro:macros -->
  <!-- Custom plugin which controls the car using a given vehicle model.
   It controls the car by setting its velocity and position
   and the steering angle of the wheels -->
  <gazebo>
    <plugin filename="libgazebo_race_car_model.so" name="race_car">
      <update_rate>1000.0</update_rate>
      <publish_rate>200.0</publish_rate>
      <vehicle_model>DynamicBicycle</vehicle_model>
      <front_left_wheel_steering>left_steering_hinge_joint</front_left_wheel_steering>
      <front_right_wheel_steering>right_steering_hinge_joint</front_right_wheel_steering>
      <front_left_wheel>front_left_wheel_joint</front_left_wheel>
      <front_right_wheel>front_right_wheel_joint</front_right_wheel>
      <rear_left_wheel>rear_left_wheel_joint</rear_left_wheel>
      <rear_right_wheel>rear_right_wheel_joint</rear_right_wheel>
      <yaml_config>/home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/robots/eufs/configDry.yaml</yaml_config>
      <noise_config>/home/unai/FSB/fsb_sim/install/eufs_models/share/eufs_models/config/noise.yaml</noise_config>
      <referenceFrame>map</referenceFrame>
      <robotFrame>base_footprint</robotFrame>
      <publishTransform>true</publishTransform>
      <groundTruthCarStateTopic>/ground_truth/state</groundTruthCarStateTopic>
      <localisationCarStateTopic>/odometry_integration/car_state</localisationCarStateTopic>
      <wheelSpeedsTopicName>/ros_can/wheel_speeds</wheelSpeedsTopicName>
      <groundTruthWheelSpeedsTopicName>/ground_truth/wheel_speeds</groundTruthWheelSpeedsTopicName>
      <odometryTopicName>/ground_truth/odom</odometryTopicName>
      <commandMode>acceleration</commandMode>
      <controlDelay>0.2</controlDelay>
      <!-- The time in seconds it takes for the car to go from lock to lock -->
      <steeringLockTime>1</steeringLockTime>
      <pubGroundTruth>true</pubGroundTruth>
    </plugin>
  </gazebo>
  <gazebo>
    <plugin filename="libgazebo_cone_ground_truth.so" name="cone_ground_truth">
      <alwaysOn>true</alwaysOn>
      <updateRate>25.0</updateRate>
      <cameraViewDistance>15</cameraViewDistance>
      <lidarViewDistance>100</lidarViewDistance>
      <lidarXViewDistance>20</lidarXViewDistance>
      <lidarYViewDistance>10</lidarYViewDistance>
      <lidarMinViewDistance>1</lidarMinViewDistance>
      <cameraMinViewDistance>1</cameraMinViewDistance>
      <cameraFOV>1.918889</cameraFOV>
      <!--110 degrees-->
      <lidarFOV>3.141593</lidarFOV>
      <!-- 180 degrees-->
      <lidarOn>true</lidarOn>
      <!--If false, we only simulate camera measurements-->
      <trackFrame>map</trackFrame>
      <groundTruthConesTopicName>/ground_truth/cones</groundTruthConesTopicName>
      <groundTruthConeMarkersTopicName>/ground_truth/cones/viz</groundTruthConeMarkersTopicName>
      <groundTruthTrackTopicName>/ground_truth/track</groundTruthTrackTopicName>
      <simulatePerception>true</simulatePerception>
      <perceptionConesTopicName>/fusion/cones</perceptionConesTopicName>
      <perceptionConeMarkersTopicName>/fusion/cones/viz</perceptionConeMarkersTopicName>
      <perceptionCameraDepthNoiseParameterA>0.0184</perceptionCameraDepthNoiseParameterA>
      <perceptionCameraDepthNoiseParameterB>0.2106</perceptionCameraDepthNoiseParameterB>
      <perceptionLidarNoise>0.03 0.03 0.0</perceptionLidarNoise>
      <pubGroundTruth>true</pubGroundTruth>
    </plugin>
  </gazebo>
  <!-- *************** -->
  <!-- Robots Elements -->
  <!-- *************** -->
  <!-- BASE FOOTPRINT -->
  <link name="base_footprint"/>
  <joint name="chassis_joint" type="fixed">
    <parent link="base_footprint"/>
    <child link="chassis"/>
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <axis xyz="1 0 0"/>
  </joint>
  <link name="chassis">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/meshes/sisu-20d.dae"/>
      </geometry>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="140"/>
      <inertia ixx="16.3" ixy="0" ixz="0" iyy="33.6" iyz="0" izz="47.9"/>
    </inertial>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/meshes/sisu-20d.dae"/>
      </geometry>
    </collision>
  </link>
  <!-- ********** -->
  <!-- Parameters -->
  <!-- ********** -->
  <!-- ***************** -->
  <!-- Wheel description -->
  <!-- ***************** -->
  <!-- ********************************* -->
  <!-- Front and rear wheel descriptions -->
  <!-- ********************************* -->
  <!-- ************** -->
  <!-- Add the wheels -->
  <!-- ************** -->
  <joint name="left_steering_hinge_joint" type="revolute">
    <origin rpy="0 0 0" xyz="0.79                      0.7000000000000001                      0"/>
    <parent link="base_footprint"/>
    <child link="left_steering_hinge"/>
    <axis xyz="0 0 1"/>
    <limit effort="10000000" lower="-0.52" upper="0.52" velocity="1000000"/>
  </joint>
  <link name="left_steering_hinge">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="1"/>
      <inertia ixx="0.04" ixy="0.0" ixz="0.0" iyy="0.04" iyz="0.0" izz="0.04"/>
    </inertial>
  </link>
  <joint name="front_left_wheel_joint" type="continuous">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="left_steering_hinge"/>
    <child link="left_front_wheel"/>
    <axis xyz="0 1 0"/>
    <limit effort="10000000" lower="0" upper="0" velocity="1000000"/>
  </joint>
  <link name="left_front_wheel">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="10.0"/>
      <inertia ixx="0.3" ixy="0" ixz="0" iyy="0.2" iyz="0" izz="0.2"/>
    </inertial>
    <visual>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/meshes/wheel_left.dae"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.2525"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="left_front_wheel">
    <material>Gazebo/Black</material>
    <mu1>2</mu1>
    <mu2>2</mu2>
    <!-- <minDepth>0.005</minDepth> -->
    <kp>100000000.0</kp>
  </gazebo>
  <joint name="right_steering_hinge_joint" type="revolute">
    <origin rpy="0 0 0" xyz="0.79                      -0.7000000000000001                      0"/>
    <parent link="base_footprint"/>
    <child link="right_steering_hinge"/>
    <axis xyz="0 0 1"/>
    <limit effort="10000000" lower="-0.52" upper="0.52" velocity="1000000"/>
  </joint>
  <link name="right_steering_hinge">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="1"/>
      <inertia ixx="0.04" ixy="0.0" ixz="0.0" iyy="0.04" iyz="0.0" izz="0.04"/>
    </inertial>
  </link>
  <joint name="front_right_wheel_joint" type="continuous">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="right_steering_hinge"/>
    <child link="right_front_wheel"/>
    <axis xyz="0 1 0"/>
    <limit effort="10000000" lower="0" upper="0" velocity="1000000"/>
  </joint>
  <link name="right_front_wheel">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="10.0"/>
      <inertia ixx="0.3" ixy="0" ixz="0" iyy="0.2" iyz="0" izz="0.2"/>
    </inertial>
    <visual>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/meshes/wheel_right.dae"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.2525"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="right_front_wheel">
    <material>Gazebo/Black</material>
    <mu1>2</mu1>
    <mu2>2</mu2>
    <!-- <minDepth>0.005</minDepth> -->
    <kp>100000000.0</kp>
  </gazebo>
  <joint name="rear_left_wheel_joint" type="continuous">
    <origin rpy="0 0 0" xyz="-0.79                      0.7000000000000001                      0"/>
    <parent link="base_footprint"/>
    <child link="left_rear_wheel"/>
    <axis xyz="0 1 0"/>
    <limit effort="10000000" lower="0" upper="0" velocity="1000000"/>
  </joint>
  <link name="left_rear_wheel">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="10.0"/>
      <inertia ixx="0.3" ixy="0" ixz="0" iyy="0.2" iyz="0" izz="0.2"/>
    </inertial>
    <visual>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/meshes/wheel_left.dae"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.2525"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="left_rear_wheel">
    <material>Gazebo/Black</material>
    <mu1>2</mu1>
    <mu2>2</mu2>
    <!-- <minDepth>0.005</minDepth> -->
    <kp>100000000.0</kp>
  </gazebo>
  <joint name="rear_right_wheel_joint" type="continuous">
    <origin rpy="0 0 0" xyz="-0.79                      -0.7000000000000001                      0"/>
    <parent link="base_footprint"/>
    <child link="right_rear_wheel"/>
    <axis xyz="0 1 0"/>
    <limit effort="10000000" lower="0" upper="0" velocity="1000000"/>
  </joint>
  <link name="right_rear_wheel">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="10.0"/>
      <inertia ixx="0.3" ixy="0" ixz="0" iyy="0.2" iyz="0" izz="0.2"/>
    </inertial>
    <visual>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_racecar/share/eufs_racecar/meshes/wheel_right.dae"/>
      </geometry>
      <material name="tire_mat"/>
    </visual>
    <collision>
      <origin rpy="1.5708 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.2525"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="right_rear_wheel">
    <material>Gazebo/Black</material>
    <mu1>2</mu1>
    <mu2>2</mu2>
    <!-- <minDepth>0.005</minDepth> -->
    <kp>100000000.0</kp>
  </gazebo>
  <!-- *********************************************** -->
  <!--                 MAIN SENSORS                    -->
  <!-- *********************************************** -->
  <!--     LOCATIONS: (XYZ)
    IMU: 0.0 0.0 0.170
    GPS: -0.110 0.0 0.9
    LIDAR: 1.700 0.0 -0.150
    STEREO CAM: -0.110 0.0 0.800 -->
  <joint name="imu_base_joint" type="fixed">
    <axis xyz="1 0 0"/>
    <origin rpy="0 0 0" xyz="0.0 0.0 0.0"/>
    <parent link="base_footprint"/>
    <child link="imu_base_link"/>
  </joint>
  <link name="imu_base_link">
    <inertial>
      <mass value="0.001"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.000001" iyz="0" izz="0.0001"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.001 0.001 0.001"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size=".001 .001 .001"/>
      </geometry>
    </collision>
  </link>
  <gazebo reference="imu_base_link">
    <gravity>true</gravity>
    <sensor name="imu_sensor" type="imu">
      <always_on>true</always_on>
      <update_rate>1000</update_rate>
      <visualize>true</visualize>
      <topic>__default_topic__</topic>
      <imu>
        <angular_velocity>
          <x>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.08</stddev>
            </noise>
          </x>
          <y>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.08</stddev>
            </noise>
          </y>
          <z>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.08</stddev>
            </noise>
          </z>
        </angular_velocity>
        <linear_acceleration>
          <x>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.08</stddev>
            </noise>
          </x>
          <y>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.08</stddev>
            </noise>
          </y>
          <z>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.08</stddev>
            </noise>
          </z>
        </linear_acceleration>
      </imu>
      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu">
        <ros>
          <remapping>~/out:=imu</remapping>
        </ros>
        <frame_name>imu_base_link</frame_name>
        <initial_orientation_as_reference>false</initial_orientation_as_reference>
      </plugin>
      <pose>0 0 0 0 0 0</pose>
    </sensor>
  </gazebo>
  <!-- ANTENNA GPS -->
  <joint name="gps_joint" type="fixed">
    <axis xyz="0 1 0"/>
    <origin rpy="0 0 0" xyz="0.0 0.0 0.4"/>
    <parent link="base_footprint"/>
    <child link="gps_base_link"/>
  </joint>
  <link name="gps_base_link">
    <inertial>
      <mass value="0.001"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.000001" iyz="0" izz="0.0001"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.001 0.001 0.001"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size=".001 .001 .001"/>
      </geometry>
    </collision>
    <!--        <visual>-->
    <!--            <origin rpy="0 0 0" xyz="0 0 0"/>-->
    <!--            <material name="gps_color">-->
    <!--                <color rgba="1 1 1 1"/>-->
    <!--            </material>-->
    <!--            <geometry>-->
    <!--                <mesh filename="file://$(find eufs_sensors)/meshes/antenna_3GO16.stl" scale="1.0 1.0 1.0"/>-->
    <!--            </geometry>-->
    <!--        </visual>-->
    <!--        <collision>-->
    <!--            <origin rpy="0 0 0" xyz="0 0 0"/>-->
    <!--            <geometry>-->
    <!--                <mesh filename="file://$(find eufs_sensors)/meshes/antenna_3GO16.stl" scale="1.0 1.0 1.0"/>-->
    <!--            </geometry>-->
    <!--        </collision>-->
  </link>
  <gazebo reference="gps_base_link">
    <material>Gazebo/White</material>
    <gravity>true</gravity>
  </gazebo>
  <gazebo reference="gps_base_link">
    <sensor name="gps" type="gps">
      <always_on>true</always_on>
      <update_rate>5</update_rate>
      <gps>
        <position_sensing>
          <horizontal>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>2</stddev>
            </noise>
          </horizontal>
          <vertical>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>2.5</stddev>
            </noise>
          </vertical>
        </position_sensing>
        <velocity_sensing>
          <horizontal>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.1</stddev>
            </noise>
          </horizontal>
          <vertical>
            <noise type="gaussian">
              <mean>0.0</mean>
              <stddev>0.1</stddev>
            </noise>
          </vertical>
        </velocity_sensing>
      </gps>
      <plugin filename="libgazebo_ros_gps_sensor.so" name="gps_controller">
        <ros>
          <remapping>~/out:=gps</remapping>
        </ros>
        <frame_name>gps_base_link</frame_name>
      </plugin>
    </sensor>
  </gazebo>
  <joint name="velodyne_base_mount_joint" type="fixed">
    <origin rpy="0 0.017453292519943295 0" xyz="-0.15 0.0 0.79"/>
    <parent link="base_footprint"/>
    <child link="velodyne_base_link"/>
  </joint>
  <link name="velodyne_base_link">
    <inertial>
      <mass value="0.83"/>
      <origin xyz="0 0 0.03585"/>
      <inertia ixx="0.000908059425" ixy="0" ixz="0" iyy="0.000908059425" iyz="0" izz="0.0011049624"/>
    </inertial>
    <visual>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_sensors/share/eufs_sensors/meshes/VLP16_base_1.dae"/>
      </geometry>
    </visual>
    <visual>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_sensors/share/eufs_sensors/meshes/VLP16_base_2.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0.03585"/>
      <geometry>
        <cylinder length="0.0717" radius="0.0516"/>
      </geometry>
    </collision>
  </link>
  <joint name="velodyne_base_scan_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0 0 0.0377"/>
    <parent link="velodyne_base_link"/>
    <child link="velodyne"/>
  </joint>
  <link name="velodyne">
    <inertial>
      <mass value="0.01"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="1e-7" ixy="0" ixz="0" iyy="1e-7" iyz="0" izz="1e-7"/>
    </inertial>
    <visual>
      <origin xyz="0 0 -0.0377"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_sensors/share/eufs_sensors/meshes/VLP16_scan.dae"/>
      </geometry>
    </visual>
  </link>
  <joint name="zed_base_joint" type="fixed">
    <axis xyz="1 0 0"/>
    <origin rpy="0 0 0" xyz="-0.08 0.0 0.76"/>
    <parent link="base_footprint"/>
    <child link="zed_camera_center"/>
  </joint>
  <link name="zed_camera_center">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="file:///home/unai/FSB/fsb_sim/install/eufs_sensors/share/eufs_sensors/meshes/zed.dae"/>
      </geometry>
      <material name="light_grey">
        <color rgba="0.8 0.8 0.8 0.8"/>
      </material>
    </visual>
  </link>
  <!-- Left and right frames -->
  <link name="zed_left_camera_frame"/>
  <link name="zed_right_camera_frame"/>
  <link name="zed_left_camera_optical_frame"/>
  <link name="zed_right_camera_optical_frame"/>
  <joint name="zed_left_camera_joint" type="fixed">
    <parent link="zed_camera_center"/>
    <child link="zed_left_camera_frame"/>
    <origin rpy="0 0 0" xyz="0 0.06 0"/>
  </joint>
  <joint name="zed_right_camera_joint" type="fixed">
    <parent link="zed_camera_center"/>
    <child link="zed_right_camera_frame"/>
    <origin rpy="0 0 0" xyz="0 -0.06 0"/>
  </joint>
  <joint name="left_camera_optical_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0 0 0"/>
    <parent link="zed_left_camera_frame"/>
    <child link="zed_left_camera_optical_frame"/>
  </joint>
  <joint name="right_camera_optical_joint" type="fixed">
    <origin rpy="0.0 0.0 0.0" xyz="0 0 0"/>
    <parent link="zed_right_camera_frame"/>
    <child link="zed_right_camera_optical_frame"/>
  </joint>
  <!-- depth frame -->
  <link name="zed_depth_camera_frame"/>
  <joint name="zed_depth_camera" type="fixed">
    <parent link="zed_camera_center"/>
    <child link="zed_depth_camera_frame"/>
    <origin rpy="0 0 0" xyz="0 0.06 0"/>
  </joint>
</robot>
